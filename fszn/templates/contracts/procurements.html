{% extends 'base.html' %}

{% block title %}é‡‡è´­æ¸…å• - {{ contract.project_code }}{% endblock %}

{% block content %}
<h1>é‡‡è´­æ¸…å•</h1>

<p>
    <strong>é¡¹ç›®ç¼–å·ï¼š</strong>{{ contract.project_code }}<br>
    <strong>åˆåŒåç§°ï¼š</strong>{{ contract.name }}
</p>

<!-- å¯¼èˆª -->
<p>
    <a href="{{ url_for('contracts.list_contracts') }}">è¿”å›é¡¹ç›®åˆ—è¡¨</a> |
    <a href="{{ url_for('contracts.manage_leaders', contract_id=contract.id) }}">éƒ¨é—¨è´Ÿè´£äºº</a> |
    <a href="{{ url_for('contracts.manage_tasks', contract_id=contract.id) }}">ä»»åŠ¡/è¿›åº¦</a> |
    <a href="{{ url_for('contracts.manage_procurements', contract_id=contract.id) }}">é‡‡è´­æ¸…å•</a> |
    <a href="{{ url_for('contracts.manage_acceptances', contract_id=contract.id) }}">éªŒæ”¶</a> |
    <a href="{{ url_for('contracts.manage_payments', contract_id=contract.id) }}">ä»˜æ¬¾</a> |
    <a href="{{ url_for('contracts.manage_invoices', contract_id=contract.id) }}">å¼€ç¥¨</a> |
    <a href="{{ url_for('contracts.manage_refunds', contract_id=contract.id) }}">é€€æ¬¾</a> |
    <a href="{{ url_for('contracts.manage_feedbacks', contract_id=contract.id) }}">å®¢æˆ·åé¦ˆ</a>
    <a href="{{ url_for('contracts.manage_files', contract_id=contract.id) }}">æ–‡ä»¶</a>

</p>

<h2>å½“å‰é‡‡è´­é¡¹ç›®</h2>
  {% if items %}
<table border="1" cellpadding="4" cellspacing="0">
    <thead>
        <tr>
            <th>ID</th>
            <th>ç‰©æ–™åç§°</th>
            <th>æ•°é‡</th>
            <th>å•ä½</th>
            <th>é¢„è®¡åˆ°è´§æ—¥æœŸ</th>
            <th>çŠ¶æ€</th>
            <th>è´Ÿè´£äºº</th>  <!-- ğŸ”¹ æ–°å¢ -->
            <th>å¤‡æ³¨</th>
            <th>æ“ä½œ</th>
        </tr>
    </thead>
    <tbody>
        {% for it in items %}
        <tr>
            <td>{{ it.id }}</td>
            <td>{{ it.item_name }}</td>
            <td>{{ it.quantity }}</td>
            <td>{{ it.unit }}</td>
            <td>{{ it.expected_date or '' }}</td>
            <td>{{ it.status }}</td>
            <td>{{ it.person.name if it.person else '' }}</td>  <!-- ğŸ”¹ æ–°å¢ -->
            <td>{{ it.remarks }}</td>
            <td>
                <form method="post"
                      action="{{ url_for('contracts.delete_procurement', contract_id=contract.id, item_id=it.id) }}"
                      style="display:inline;">
                    <button type="submit" onclick="return confirm('ç¡®è®¤åˆ é™¤è¯¥é‡‡è´­é¡¹ï¼Ÿ');">åˆ é™¤</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
  {% else %}
<p>å½“å‰è¿˜æ²¡æœ‰é‡‡è´­é¡¹ã€‚</p>
  {% endif %}

<h2>æ–°å¢é‡‡è´­é¡¹</h2>
<form method="post">
    <p>
        <label>
            ç‰©æ–™åç§°ï¼š
            <input type="text" name="item_name">
        </label>
    </p>
    <p>
        <label>
            æ•°é‡ï¼š
            <input type="number" name="quantity">
        </label>
    </p>
    <p>
        <label>
            å•ä½ï¼š
            <input type="text" name="unit">
        </label>
    </p>
    <p>
        <label>
            é¢„è®¡åˆ°è´§æ—¥æœŸï¼š
            <input type="date" name="expected_date">
        </label>
    </p>
    <p>
        <label>
            çŠ¶æ€ï¼š
            <input type="text" name="status" placeholder="å¦‚ï¼šæœªé‡‡è´­/å·²ä¸‹å•/è¿è¾“ä¸­/å·²åˆ°è´§">
        </label>
    </p>
    <p>
        <label>
            è´Ÿè´£äººï¼š
            <select name="person_id">
                <option value="">æœªæŒ‡å®š</option>
                {% for p in persons %}
                <option value="{{ p.id }}">{{ p.name }} - {{ p.position }} (ID={{ p.id }})</option>
                {% endfor %}
            </select>
        </label>
    </p>
    <p>
        <label>
            å¤‡æ³¨ï¼š
            <textarea name="remarks" rows="3" cols="50"></textarea>
        </label>
    </p>
    <p>
        <button type="submit">ä¿å­˜é‡‡è´­é¡¹</button>
    </p>
</form>
{% endblock %}
